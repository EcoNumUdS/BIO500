---
title: "Exporter un tableau de résultats dans un rapport LaTeX"
author: Steve Vissault
date: 11 avril 2018
output:
  html_document:
    theme: united
    highlight: tango
    df_print: paged
---


Il est parfois incontournable en science de présenter des résultats sous forme de tableaux. À
travers cette page, je vais vous montrer comment exporter votre tableau en format LaTeX pour après
l'insérer dans votre rapport. La procédure est assez simple: il s'agit d'écrire le tableau LaTeX
dans un fichier, puis après d'inclure ce tableau dans votre document LaTeX en utilisant la balise
LaTeX: `montableau.tex`

Pour l'illustration, je vais utiliser un tableau de données déjà présent dans R: iris.
Je vais ensuite me servir du package R `kable` pour transformer l'objet `iris`, qui une fois chargé
sera un objet de classe `data.frame`, en un tableau LaTeX.

```{r}
data(iris) # Chargement du tableau de données
str(iris) # Après importation d'un jeu de données, on vérifie toujours la structure
```

L'objet `iris` est de type `data.frame` et dispose de 150 lignes et 5 variables (colonnes).
Je sais donc à présent que mon importation dans R a fonctionné.
Je vais donc maintenant calculer la moyenne de la longueur des sépales, l'écart type et la taille
de l'échantillon pour chacune des espèces.

```{r}
mn <- by(iris$Sepal.Length,iris$Species,mean) # Calcul de la moyenne
s <- by(iris$Sepal.Length,iris$Species,sd) # Calcul de l'écart type
len <- by(iris$Sepal.Length,iris$Species,length) # Calcul de la taille de l'échantillon

# On assemble le tableau contenant les statistiques descriptives
stats_desc <- data.frame(Espèces = names(c(mn)), moyenne = c(mn), ÉcartType = c(s), n = c(len) )
print(stats_desc)
```

Je veux maintenant inclure ce tableau de statistiques descriptives `stats_desc` dans mon rapport. Je
dois d'abord convertir l'objet `stats_desc` en une série d'instructions LaTeX. Pour ce faire, je
vais utiliser la fonction `xtable` présent le package `xtable`. Il existe cependant une multitude de
packages en R dédiés à cette tâche. Certains vous permettent de formatter plus facilement votre
tableau. Je vous invite à jeter un coup d'oeil [à ce billet sur le forum
StackOverflow](https://stackoverflow.com/questions/5465314/tools-for-making-latex-tables-in-r?utm_medium=organic&utm_source=google_rich_qa&utm_campaign=google_rich_qa).

```{r}
if(!require(xtable)){install.packages("xtable")} # Charge le paquet xtable, s'il n'est pas installé, alors R l'installera.
stats_desc_tex <- xtable(stats_desc,format="latex",caption = 'Statistiques descriptives de la longeur du sépale chez \textit{Iris sp.}', caption.placement="top",)
# On ajoute une légende avec l'argument caption que l'on place au-dessus du tableau.
print(stats_desc_tex) # Je visualise le contenu de l'objet
```

Je vais maintenant écrire le contenu de l'objet `stats_desc_tex` dans un fichier. Nous ne pouvons
pas utiliser les fonctions d'exportation habituelles tels que `write.table` ou encore `write.csv`
car le le contenu de cette objet n'est pas un `data.frame` mais un tableau LaTeX. Il nous faut donc
utiliser un fonction d'écriture qui écrit sans transformation le contenu de l'objet dans un fichier.
On utilise la fonction `print` du packages `xtable` pour réaliser cette étape.

```{r}
print(stats_desc_tex,file="stats_iris.tex") # Le fichier stats_iris.tex sera écrit à l'emplacement ou l'espace de travail de R se trouve. Pensez à utiliser getwd()
```

Un nouveau fichier intitulé `stats_iris.tex` vient d'être écrit sur votre disque à l'endroit ou l'espace de travail de R était définit (pensez `getwd()`).
On peut maintenant utiliser ce fichier pour notre rapport LaTeX.

On ouvre notre document LaTeX et on ajoute tout simplement la balise LaTeX suivante à l'emplacement où l'on désire voir apparaitre notre tableau.

```LaTeX
\input{stats_iris.tex}
```

La balise `input` va tout simplement copier-coller/inclure le code LaTeX contenu dans votre fichier `stats_iris.tex` dans votre document LaTeX.
Il ne vous reste plus qu'à compiler votre rapport telle que vu dans les cours précédents.
